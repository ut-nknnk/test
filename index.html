<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ポーカー オープンポジション クイズ (40bb) - UTG+1～BTNオープン限定</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Tailwind gray-900 */
            color: #e2e8f0; /* Tailwind slate-200 */
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
        .quiz-panel {
            background-color: #2d3748; /* Tailwind gray-800 */
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            text-align: center;
            padding: 1.5rem;
        }
        @media (min-width: 640px) {
            .quiz-panel {
                padding: 2rem;
            }
        }
        .card-display {
            font-family: 'Inter', sans-serif; /* Keep Inter for cards for clarity */
            font-weight: 700;
            font-size: 2.8rem; /* Increased size slightly */
            color: #f6e05e; /* Tailwind yellow-300 */
            margin-bottom: 1.5rem;
            min-height: 3.5rem; /* Ensure space for hand */
        }
        .btn-action {
            transition: all 0.2s ease-in-out;
            border-width: 2px;
            border-style: solid;
            font-weight: 600;
            padding-top: 0.6rem; 
            padding-bottom: 0.6rem;
            padding-left: 0.8rem;
            padding-right: 0.8rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            font-size: 0.875rem; 
            min-width: 60px; 
        }
        .btn-action:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
        }
        /* Position Button Styles */
        /* UTG button style is kept for consistency in case it's re-added, but button is removed from HTML */
        .btn-pos-utg { background-color: #c53030; border-color: #9b2c2c; color: white; } 
        .btn-pos-utg:hover:not(:disabled) { background-color: #9b2c2c; }

        .btn-pos-utgplus1 { background-color: #dd6b20; border-color: #c05621; color: white; } 
        .btn-pos-utgplus1:hover:not(:disabled) { background-color: #c05621; }

        .btn-pos-mp { background-color: #d69e2e; border-color: #b7791f; color: white; } 
        .btn-pos-mp:hover:not(:disabled) { background-color: #b7791f; }

        .btn-pos-hj { background-color: #dede00; border-color: #cccc00; color: #1a202c; } 
        .btn-pos-hj:hover:not(:disabled) { background-color: #cccc00; }

        .btn-pos-co { background-color: #68d391; border-color: #48bb78; color: white; } 
        .btn-pos-co:hover:not(:disabled) { background-color: #48bb78; }

        .btn-pos-btn { background-color: #38a169; border-color: #2f855a; color: white; } 
        .btn-pos-btn:hover:not(:disabled) { background-color: #2f855a; }

        /* FOLD button style is kept for consistency, but button is removed from HTML */
        .btn-pos-fold { background-color: #718096; border-color: #4a5568; color: white; } 
        .btn-pos-fold:hover:not(:disabled) { background-color: #4a5568; }

        .btn-reset { background-color: #ecc94b; border-color: #d69e2e; color: #1a202c; }
        .btn-reset:hover:not(:disabled) { background-color: #d69e2e; }

        .feedback-correct { color: #48bb78; } 
        .feedback-incorrect { color: #f56565; } 
        .feedback-neutral { color: #63b3ed; } 

        .score-board {
            background-color: #4a5568; 
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: inset 0 2px 4px 0 rgba(0,0,0,0.06);
            font-size: 0.875rem;
        }
        .score-board p span {
            font-weight: 600;
        }
        .disabled-button {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .next-hand-btn {
            background-color: #38a169; 
            color: white;
            font-weight: 700;
        }
        .next-hand-btn:hover:not(:disabled) { background-color: #2f855a; }
    </style>
</head>
<body class="flex flex-col items-center min-h-screen">
    <div class="w-full max-w-5xl mx-auto px-4">
        <h1 class="text-3xl font-bold mb-2 text-sky-400 text-center">ポーカー オープンポジション クイズ (40bb)</h1>
        <p class="text-center text-sky-200 mb-6 text-sm">UTGオープンとフォールドを除く、UTG+1からBTNの間でオープンになるハンドのみをクイズします。</p>

        <div class="flex flex-col sm:flex-row gap-4 md:gap-6">
            <div id="offsuitQuizPanel" class="quiz-panel flex-1">
                <h2 class="text-xl font-semibold mb-4 text-sky-300">オフスート ポジションクイズ</h2>
                <div class="my-6 p-4 bg-gray-700 rounded-lg shadow-inner">
                    <p class="text-sm mb-1 text-gray-400">現在のハンド:</p>
                    <div id="offsuit_handDisplay" class="card-display">--</div>
                </div>
                <div id="offsuit_actionButtonsContainer" class="flex flex-wrap justify-center gap-2 mb-4">
                    <button id="offsuit_btnUTGPlus1" class="btn-action btn-pos-utgplus1">UTG+1</button>
                    <button id="offsuit_btnMP" class="btn-action btn-pos-mp">MP</button>
                    <button id="offsuit_btnHJ" class="btn-action btn-pos-hj">HJ</button>
                    <button id="offsuit_btnCO" class="btn-action btn-pos-co">CO</button>
                    <button id="offsuit_btnBTN" class="btn-action btn-pos-btn">BTN</button>
                </div>
                <div id="offsuit_feedbackArea" class="min-h-[3em] text-md font-semibold mb-4"></div>
                <div class="score-board mb-4 text-lg">
                    <p>スコア: <span id="offsuit_correctCount">0</span>/<span id="offsuit_totalAttempts">0</span> (<span id="offsuit_accuracy">0</span>%)</p>
                    <p>連続正解: <span id="offsuit_streakCount">0</span></p>
                    <p>残り: <span id="offsuit_remainingCount">0</span> 問</p>
                </div>
                <button id="offsuit_nextHandButton" class="w-full btn-action next-hand-btn mb-2" style="display: none;">次のハンド</button>
                <button id="offsuit_resetButton" class="w-full btn-action btn-reset">リセット</button>
            </div>

            <div id="suitedQuizPanel" class="quiz-panel flex-1">
                <h2 class="text-xl font-semibold mb-4 text-sky-300">スーツ＆ペア ポジションクイズ</h2>
                <div class="my-6 p-4 bg-gray-700 rounded-lg shadow-inner">
                    <p class="text-sm mb-1 text-gray-400">現在のハンド:</p>
                    <div id="suited_handDisplay" class="card-display">--</div>
                </div>
                <div id="suited_actionButtonsContainer" class="flex flex-wrap justify-center gap-2 mb-4">
                     <button id="suited_btnUTGPlus1" class="btn-action btn-pos-utgplus1">UTG+1</button>
                    <button id="suited_btnMP" class="btn-action btn-pos-mp">MP</button>
                    <button id="suited_btnHJ" class="btn-action btn-pos-hj">HJ</button>
                    <button id="suited_btnCO" class="btn-action btn-pos-co">CO</button>
                    <button id="suited_btnBTN" class="btn-action btn-pos-btn">BTN</button>
                </div>
                <div id="suited_feedbackArea" class="min-h-[3em] text-md font-semibold mb-4"></div>
                <div class="score-board mb-4 text-lg">
                    <p>スコア: <span id="suited_correctCount">0</span>/<span id="suited_totalAttempts">0</span> (<span id="suited_accuracy">0</span>%)</p>
                    <p>連続正解: <span id="suited_streakCount">0</span></p>
                    <p>残り: <span id="suited_remainingCount">0</span> 問</p>
                </div>
                <button id="suited_nextHandButton" class="w-full btn-action next-hand-btn mb-2" style="display: none;">次のハンド</button>
                <button id="suited_resetButton" class="w-full btn-action btn-reset">リセット</button>
            </div>
        </div>
    </div>

    <script>
        // --- 定数定義 ---
        const POSITIONS = {
            UTG: "UTG", // Still defined for positionalHandChart logic
            UTG1: "UTG+1",
            MP: "MP",
            HJ: "HJ", 
            CO: "CO", 
            BTN: "BTN", 
            FOLD: "FOLD" // Still defined for positionalHandChart logic
        };

        // Define available actions for buttons (UTG and FOLD removed)
        const BUTTON_ACTIONS = [POSITIONS.UTG1, POSITIONS.MP, POSITIONS.HJ, POSITIONS.CO, POSITIONS.BTN];
        
        const AUTO_NEXT_DELAY = 300; 

        // UTG 8-max 40bb ハンドレンジ (元のRAISE/FOLD定義)
        const originalHandChartUTG_RaiseFold = {
          "AA": "RAISE 2.3", "KK": "RAISE 2.3", "QQ": "RAISE 2.3", "JJ": "RAISE 2.3", "TT": "RAISE 2.3",
          "99": "RAISE 2.3", "88": "RAISE 2.3", "77": "RAISE 2.3", "66": "RAISE 2.3", "55": "RAISE 2.3",
          "44": "FOLD", "33": "FOLD", "22": "FOLD",
          "AKs": "RAISE 2.3", "AQs": "RAISE 2.3", "AJs": "RAISE 2.3", "ATs": "RAISE 2.3", "A9s": "RAISE 2.3",
          "A8s": "RAISE 2.3", "A7s": "RAISE 2.3", "A6s": "RAISE 2.3", "A5s": "RAISE 2.3", "A4s": "RAISE 2.3",
          "A3s": "RAISE 2.3", "A2s": "RAISE 2.3",
          "KQs": "RAISE 2.3", "KJs": "RAISE 2.3", "KTs": "RAISE 2.3",
          "K9s": "RAISE 2.3", "K8s": "RAISE 2.3", "K7s": "RAISE 2.3", "K6s": "FOLD", "K5s": "FOLD",
          "K4s": "FOLD", "K3s": "FOLD", "K2s": "FOLD",
          "QJs": "RAISE 2.3", "QTs": "RAISE 2.3",
          "Q9s": "RAISE 2.3", "Q8s": "FOLD",
          "Q7s": "FOLD", "Q6s": "FOLD", "Q5s": "FOLD", "Q4s": "FOLD", "Q3s": "FOLD", "Q2s": "FOLD",
          "JTs": "RAISE 2.3", "J9s": "RAISE 2.3",
          "J8s": "FOLD",
          "J7s": "FOLD", "J6s": "FOLD", "J5s": "FOLD", "J4s": "FOLD", "J3s": "FOLD", "J2s": "FOLD",
          "T9s": "RAISE 2.3", "T8s": "RAISE 2.3",
          "T7s": "FOLD", "T6s": "FOLD", "T5s": "FOLD", "T4s": "FOLD", "T3s": "FOLD", "T2s": "FOLD",
          "98s": "RAISE 2.3",
          "97s": "FOLD", "96s": "FOLD", "95s": "FOLD", "94s": "FOLD", "93s": "FOLD", "92s": "FOLD",
          "87s": "RAISE 2.3",
          "86s": "FOLD", "85s": "FOLD", "84s": "FOLD", "83s": "FOLD", "82s": "FOLD",
          "76s": "RAISE 2.3",
          "75s": "FOLD", "74s": "FOLD", "73s": "FOLD", "72s": "FOLD",
          "65s": "FOLD",
          "64s": "FOLD", "63s": "FOLD", "62s": "FOLD",
          "54s": "FOLD",
          "53s": "FOLD", "52s": "FOLD",
          "43s": "FOLD", "42s": "FOLD",
          "32s": "FOLD",
          "AKo": "RAISE 2.3", "AQo": "RAISE 2.3", "AJo": "RAISE 2.3", "ATo": "RAISE 2.3", "A9o": "FOLD", "A8o": "FOLD",
          "A7o": "FOLD", "A6o": "FOLD", "A5o": "FOLD", "A4o": "FOLD", "A3o": "FOLD", "A2o": "FOLD",
          "KQo": "RAISE 2.3", "KJo": "RAISE 2.3", "KTo": "RAISE 2.3",
          "K9o": "FOLD", "K8o": "FOLD", "K7o": "FOLD", "K6o": "FOLD", "K5o": "FOLD", "K4o": "FOLD", "K3o": "FOLD", "K2o": "FOLD",
          "QJo": "RAISE 2.3", "QTo": "FOLD",
          "Q9o": "FOLD", "Q8o": "FOLD", "Q7o": "FOLD", "Q6o": "FOLD", "Q5o": "FOLD", "Q4o": "FOLD", "Q3o": "FOLD", "Q2o": "FOLD",
          "JTo": "FOLD",
          "J9o": "FOLD", "J8o": "FOLD", "J7o": "FOLD", "J6o": "FOLD", "J5o": "FOLD", "J4o": "FOLD", "J3o": "FOLD", "J2o": "FOLD",
          "T9o": "FOLD", "T8o": "FOLD", "T7o": "FOLD", "T6o": "FOLD", "T5o": "FOLD", "T4o": "FOLD", "T3o": "FOLD", "T2o": "FOLD",
          "98o": "FOLD", "97o": "FOLD", "96o": "FOLD", "95o": "FOLD", "94o": "FOLD", "93o": "FOLD", "92o": "FOLD",
          "87o": "FOLD", "86o": "FOLD", "85o": "FOLD", "84o": "FOLD", "83o": "FOLD", "82o": "FOLD",
          "76o": "FOLD", "75o": "FOLD", "74o": "FOLD", "73o": "FOLD", "72o": "FOLD",
          "65o": "FOLD", "64o": "FOLD", "63o": "FOLD", "62o": "FOLD",
          "54o": "FOLD", "53o": "FOLD", "52o": "FOLD",
          "43o": "FOLD", "42o": "FOLD",
          "32o": "FOLD"
        };
        const ranks = ['A', 'K', 'Q', 'J', 'T', '9', '8', '7', '6', '5', '4', '3', '2'];
        
        // --- Generate all 169 possible hands ---
        const allPossibleHands = [];
        for (let i = 0; i < ranks.length; i++) {
            for (let j = i; j < ranks.length; j++) {
                const r1 = ranks[i];
                const r2 = ranks[j];
                if (i === j) { // Pairs
                    allPossibleHands.push(r1 + r2);
                } else { // Suited and Offsuit
                    allPossibleHands.push(r1 + r2 + 's');
                    allPossibleHands.push(r1 + r2 + 'o');
                }
            }
        }

        // --- Define opening ranges for each position ---
        const utg_opens = new Set(
            Object.keys(originalHandChartUTG_RaiseFold)
                  .filter(h => originalHandChartUTG_RaiseFold[h] === "RAISE 2.3")
        );
        const utg1_opens_additional = new Set(["44", "K6s", "QTo", "A9o", "65s", "J8s", "Q8s"]);
        const mp_opens_additional = new Set(["K5s", "T7s", "97s", "86s", "JTo", "A8o"]);
        const hj_opens_additional = new Set(["33", "K4s", "K3s", "Q7s", "Q6s", "Q5s", "J7s", "96s","54s", "A7o", "T9o"]);
        const co_opens_additional = new Set([
            "22", "K2s", "Q4s", "Q3s", "J6s", "J5s", "T6s", "85s", "75s", "64s", "63s",
            "A6o", "A5o", "A4o", "K9o","K8o", "Q9o", "J9o", "T8o"
        ]);
        const btn_opens_additional = new Set([
            "J3s", "J2s", "T3s","Q8o","Q7o","J8o","98o","T7o","87o","97o","Q2s", "J4s",
            "T5s", "T4s","95s",  "84s", "74s","53s", "A3o", "A2o","K7o", "K6o", "K5o",
        ]);

        // --- Create the master chart mapping each hand to its earliest opening position ---
        const positionalHandChart = {};
        allPossibleHands.forEach(hand => {
            if (utg_opens.has(hand)) {
                positionalHandChart[hand] = POSITIONS.UTG;
            } else if (utg1_opens_additional.has(hand)) {
                positionalHandChart[hand] = POSITIONS.UTG1;
            } else if (mp_opens_additional.has(hand)) {
                positionalHandChart[hand] = POSITIONS.MP;
            } else if (hj_opens_additional.has(hand)) {
                positionalHandChart[hand] = POSITIONS.HJ;
            } else if (co_opens_additional.has(hand)) {
                positionalHandChart[hand] = POSITIONS.CO;
            } else if (btn_opens_additional.has(hand)) {
                positionalHandChart[hand] = POSITIONS.BTN;
            } else {
                positionalHandChart[hand] = POSITIONS.FOLD;
            }
        });

        // --- Prepare data for quizzes ---
        const offsuitChartNew = {}; // Answer key for offsuit hands
        const suitedPairsChartNew = {}; // Answer key for suited/pair hands

        const allOffsuitHandsInGame = []; // All possible offsuit hands
        const allSuitedAndPairHandsInGame = []; // All possible suited/pair hands

        Object.keys(positionalHandChart).forEach(hand => {
            const action = positionalHandChart[hand]; 
            if (hand.endsWith('o')) {
                offsuitChartNew[hand] = action;
                allOffsuitHandsInGame.push(hand);
            } else { 
                suitedPairsChartNew[hand] = action;
                allSuitedAndPairHandsInGame.push(hand);
            }
        });

        // --- Create filtered hand pools for the quizzes (excluding UTG opens AND Folds) ---
        const quizPoolOffsuit = allOffsuitHandsInGame.filter(hand => 
            positionalHandChart[hand] !== POSITIONS.UTG && positionalHandChart[hand] !== POSITIONS.FOLD
        );
        const quizPoolSuitedPairs = allSuitedAndPairHandsInGame.filter(hand => 
            positionalHandChart[hand] !== POSITIONS.UTG && positionalHandChart[hand] !== POSITIONS.FOLD
        );


        class Quiz {
            constructor(idPrefix, handChart, handPool) {
                this.idPrefix = idPrefix;
                this.handChart = handChart; 
                this.allHandsInPool = [...handPool]; 
                this.remainingHands = [...handPool]; 

                this.dom = {
                    handDisplay: document.getElementById(`${idPrefix}_handDisplay`),
                    feedbackArea: document.getElementById(`${idPrefix}_feedbackArea`),
                    correctCount: document.getElementById(`${idPrefix}_correctCount`),
                    totalAttempts: document.getElementById(`${idPrefix}_totalAttempts`),
                    accuracy: document.getElementById(`${idPrefix}_accuracy`),
                    streakCount: document.getElementById(`${idPrefix}_streakCount`),
                    remainingCount: document.getElementById(`${idPrefix}_remainingCount`),
                    nextHandButton: document.getElementById(`${idPrefix}_nextHandButton`),
                    resetButton: document.getElementById(`${idPrefix}_resetButton`),
                    actionButtons: []
                };

                this.currentHand = '';
                this.currentCorrectAction = ''; 
                this.correctAnswers = 0;
                this.totalAttempts = 0;
                this.currentStreak = 0;
                this.autoNextTimeout = null;

                this.initEventListeners();
                this.updateScoreDisplay();
                this.displayNewHand();
            }

            initEventListeners() {
                // Use the updated BUTTON_ACTIONS array
                BUTTON_ACTIONS.forEach(action => {
                    const buttonIdSuffix = action.replace('+', 'Plus'); 
                    const buttonElement = document.getElementById(`${this.idPrefix}_btn${buttonIdSuffix}`);
                    if (buttonElement) {
                        buttonElement.addEventListener('click', () => this.handleAction(action));
                        this.dom.actionButtons.push(buttonElement);
                    } else {
                        // This warning might appear for UTG and FOLD if not careful, but they are removed from BUTTON_ACTIONS
                        // console.warn(`Button with ID ${this.idPrefix}_btn${buttonIdSuffix} not found.`);
                    }
                });

                this.dom.nextHandButton.addEventListener('click', () => {
                    clearTimeout(this.autoNextTimeout);
                    this.displayNewHand();
                });
                this.dom.resetButton.addEventListener('click', () => this.resetQuiz());
            }

            getRandomHand() {
                if (this.remainingHands.length === 0) return null;
                const randomIndex = Math.floor(Math.random() * this.remainingHands.length);
                return this.remainingHands[randomIndex];
            }

            updateScoreDisplay() {
                this.dom.correctCount.textContent = this.correctAnswers;
                this.dom.totalAttempts.textContent = this.totalAttempts;
                this.dom.streakCount.textContent = this.currentStreak;
                const accuracyValue = this.totalAttempts > 0 ? ((this.correctAnswers / this.totalAttempts) * 100).toFixed(1) : 0;
                this.dom.accuracy.textContent = accuracyValue;
                this.dom.remainingCount.textContent = this.remainingHands.length;
            }

            updateScoreState(isCorrectAttempt) {
                this.totalAttempts++;
                if (isCorrectAttempt) {
                    this.correctAnswers++;
                    this.currentStreak++;
                } else {
                    this.currentStreak = 0;
                }
                this.updateScoreDisplay();
            }

            displayNewHand() {
                clearTimeout(this.autoNextTimeout);
                this.currentHand = this.getRandomHand();
                this.updateScoreDisplay(); 

                if (this.currentHand === null) {
                    this.dom.handDisplay.textContent = "全問正解!";
                    this.dom.feedbackArea.textContent = "おめでとうございます！リセットして再挑戦できます。";
                    this.dom.feedbackArea.className = 'min-h-[3em] text-md font-semibold mb-4 feedback-correct';
                    this.dom.actionButtons.forEach(button => {
                        button.disabled = true;
                        button.classList.add('disabled-button');
                    });
                    this.dom.nextHandButton.style.display = 'none';
                    return;
                }

                this.currentCorrectAction = this.handChart[this.currentHand];
                // Since quiz pools are filtered to exclude FOLD and UTG, this.currentCorrectAction should always be one of the remaining positions.
                // The undefined check is a general safeguard.
                if (typeof this.currentCorrectAction === 'undefined' || this.currentCorrectAction === POSITIONS.FOLD || this.currentCorrectAction === POSITIONS.UTG) {
                    console.error(`Error (${this.idPrefix}): Hand ${this.currentHand} has an unexpected action '${this.currentCorrectAction}' or is undefined, despite filtering. This hand should not be in the quiz pool.`);
                    // Attempt to recover by fetching another hand, or display error.
                    // For now, let's just skip it and try to get another hand.
                    this.remainingHands = this.remainingHands.filter(h => h !== this.currentHand); // Remove problematic hand
                    this.displayNewHand(); // Try again
                    return;
                 }

                this.dom.handDisplay.textContent = this.currentHand;
                this.dom.feedbackArea.textContent = '';
                this.dom.feedbackArea.className = 'min-h-[3em] text-md font-semibold mb-4';
                this.dom.actionButtons.forEach(button => {
                    button.disabled = false;
                    button.classList.remove('disabled-button');
                });
                this.dom.nextHandButton.style.display = 'none';
            }

            handleAction(chosenPosition) {
                clearTimeout(this.autoNextTimeout);
                this.dom.actionButtons.forEach(button => {
                    button.disabled = true;
                    button.classList.add('disabled-button');
                });

                const isCorrect = chosenPosition === this.currentCorrectAction;
                this.updateScoreState(isCorrect);

                if (isCorrect) {
                    this.dom.feedbackArea.textContent = `正解！ ${this.currentHand} は ${this.currentCorrectAction} からオープン。`;
                    this.dom.feedbackArea.className = 'min-h-[3em] text-md font-semibold mb-4 feedback-correct';
                    
                    const handIndex = this.remainingHands.indexOf(this.currentHand);
                    if (handIndex > -1) {
                        this.remainingHands.splice(handIndex, 1);
                    }

                    this.autoNextTimeout = setTimeout(() => {
                        this.displayNewHand();
                    }, AUTO_NEXT_DELAY);
                } else {
                    this.dom.feedbackArea.textContent = `不正解。選択: ${chosenPosition}。正解は ${this.currentCorrectAction} (${this.currentHand})。`;
                    this.dom.feedbackArea.className = 'min-h-[3em] text-md font-semibold mb-4 feedback-incorrect';
                    this.dom.nextHandButton.style.display = 'block';
                }
            }

            resetQuiz() {
                clearTimeout(this.autoNextTimeout);
                this.remainingHands = [...this.allHandsInPool]; 
                this.correctAnswers = 0;
                this.totalAttempts = 0;
                this.currentStreak = 0;
                this.updateScoreDisplay();
                this.dom.feedbackArea.textContent = 'クイズがリセットされました。';
                this.dom.feedbackArea.className = 'min-h-[3em] text-md font-semibold mb-4 feedback-neutral';
                this.dom.actionButtons.forEach(button => {
                    button.disabled = false;
                    button.classList.remove('disabled-button');
                });
                this.dom.nextHandButton.style.display = 'none';
                this.autoNextTimeout = setTimeout(() => {
                    this.displayNewHand();
                }, 1000);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            if (quizPoolOffsuit.length > 0) {
                new Quiz('offsuit', offsuitChartNew, quizPoolOffsuit);
            } else {
                const panel = document.getElementById('offsuitQuizPanel');
                if(panel) panel.innerHTML = '<p class="text-center text-yellow-400 p-4">クイズ対象のオフスートハンドがありません (UTGオープンおよびフォールドを除く)。</p>';
            }

            if (quizPoolSuitedPairs.length > 0) {
                new Quiz('suited', suitedPairsChartNew, quizPoolSuitedPairs);
            } else {
                 const panel = document.getElementById('suitedQuizPanel');
                 if(panel) panel.innerHTML = '<p class="text-center text-yellow-400 p-4">クイズ対象のスーツ/ペアハンドがありません (UTGオープンおよびフォールドを除く)。</p>';
            }
        });
    </script>
</body>
</html>
